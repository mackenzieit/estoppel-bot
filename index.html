<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Estoppel Letter Bot</title>

    <!-- OpenAI domain verification: keep YOUR real key -->
    <meta name="openai-domain-verification" content="domain_pk_691016fbbcec81908e8cc5bea8b2c8a007286564828bd656" />

    <!-- ChatKit SDK (from the docs). Use DEFER, not async, so it loads before init
    <script src="https://cdn.platform.openai.com/deployments/chatkit/chatkit.js?v=2" defer></script>
        <script src="https://cdn.platform.openai.com/deployments/chatkit/chatkit.js" defer></script>
        <script src="https://cdn.platform.openai.com/deployments/chatkit/chatkit.js?v=2" defer></script>

    -->
    <script
    src="https://cdn.platform.openai.com/deployments/chatkit/chatkit.js"
    async
    ></script>

    <style>
      html, body { height:100%; margin:0; background:#f9fafb; color:#1e293b;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
      @media (prefers-color-scheme: dark) { body { background:#0f172a; color:#e2e8f0; } }
      #chat { height:100vh; width:100vw; display:flex; align-items:center; justify-content:center; }
      .loading { font-size:1.1rem; opacity:.7; }
      #err { position:fixed; left:12px; bottom:12px; font:12px/1.4 monospace; color:#b91c1c; }
    </style>
  </head>
  <body>
    <div id="chat"><div class="loading">Loading Estoppel Letter Bot...</div></div>
    <div id="err"></div>

<script>
  async function initChatKit() {
    try {
      const res = await fetch("/api/chatkit-session", { method: "POST" });
      if (!res.ok) throw new Error("API " + res.status);
      const { client_secret } = await res.json();

      if (!window.ChatKit) throw new Error("ChatKit SDK not loaded yet");
      window.ChatKit.open({
        client_secret,
        theme: "light"
      });
    } catch (e) {
      console.error("‚ùå ChatKit init failed:", e);
    }
  }
  window.addEventListener("load", initChatKit);
</script>



  </body>
</html>
